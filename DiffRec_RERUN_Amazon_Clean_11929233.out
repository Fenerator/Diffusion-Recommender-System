args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, reweight=True, round=1, sampling_noise=False, save_path='./saved_models/', time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, weight_decay=0.0)
args: Namespace(batch_size=400, cuda=True, data_path='./datasets/', dataset='amazon-book_clean', dims='[1000]', emb_size=10, epochs=1000, gpu='1', log_name='log', lr=0.0001, mean_type='x0', model_type='DiffRec', noise_max=0.02, noise_min=0.0001, noise_scale=0.1, noise_schedule='linear-var', norm=False, num_workers=0, reweight=True, round=1, sampling_noise=False, sampling_steps=0, save_path='./saved_models/', steps=5, time_type='cat', topN='[10, 20, 50, 100]', tst_w_val=False, weight_decay=0.0)
Starting time:  2023-06-15 12:24:03
user num: 108822
item num: 94949
data ready.
models ready.
Number of all parameters: 190004059
Start training...
Runing Epoch 001 train loss 1283.6285 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 002 train loss 1190.7160 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 003 train loss 1166.4492 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 004 train loss 1150.5107 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0062
0.005
0.0034
0.0025 
Recall:
 0.0178
0.0275
0.0443
0.061 
NDCG:
 0.0131
0.0162
0.0211
0.0251 
MRR:
 0.02
0.0218
0.0233
0.0238
[Test]:  
Precision:
 0.0067
0.0051
0.0034
0.0024 
Recall:
 0.0308
0.0444
0.0693
0.0928 
NDCG:
 0.0207
0.0249
0.0311
0.036 
MRR:
0.0244
0.0262
0.0276
0.0282
Runing Epoch 005 train loss 1132.8237 costs 00: 02: 48
------------------------------------------------------
Runing Epoch 006 train loss 1126.2553 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 007 train loss 1115.2668 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 008 train loss 1109.6621 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 009 train loss 1102.5965 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0086
0.0069
0.0048
0.0035 
Recall:
 0.0253
0.0386
0.0624
0.086 
NDCG:
 0.0183
0.0227
0.0295
0.0354 
MRR:
 0.027
0.0296
0.0315
0.0323
[Test]:  
Precision:
 0.01
0.0076
0.0049
0.0035 
Recall:
 0.0464
0.0664
0.1009
0.1342 
NDCG:
 0.0311
0.0372
0.046
0.053 
MRR:
0.036
0.0386
0.0405
0.0413
Runing Epoch 010 train loss 1096.0783 costs 00: 02: 49
------------------------------------------------------
Runing Epoch 011 train loss 1094.9122 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 012 train loss 1088.8847 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 013 train loss 1089.0082 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 014 train loss 1084.4461 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0101
0.0082
0.0059
0.0043 
Recall:
 0.0309
0.0478
0.0793
0.1114 
NDCG:
 0.0218
0.0275
0.0363
0.0441 
MRR:
 0.0314
0.0345
0.0369
0.0379
[Test]:  
Precision:
 0.0121
0.0091
0.006
0.0043 
Recall:
 0.0575
0.0827
0.1276
0.1724 
NDCG:
 0.0376
0.0453
0.0564
0.0658 
MRR:
0.0424
0.0455
0.048
0.0489
Runing Epoch 015 train loss 1086.4931 costs 00: 02: 49
------------------------------------------------------
Runing Epoch 016 train loss 1084.3058 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 017 train loss 1087.2337 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 018 train loss 1079.0183 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 019 train loss 1082.1424 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0103
0.0084
0.006
0.0044 
Recall:
 0.0315
0.0491
0.0809
0.1145 
NDCG:
 0.0222
0.028
0.037
0.045 
MRR:
 0.0316
0.0348
0.0373
0.0383
[Test]:  
Precision:
 0.0123
0.0093
0.0062
0.0044 
Recall:
 0.0588
0.0846
0.1305
0.1764 
NDCG:
 0.0384
0.0462
0.0576
0.0672 
MRR:
0.0432
0.0464
0.0489
0.0499
Runing Epoch 020 train loss 1080.8904 costs 00: 02: 49
------------------------------------------------------
Runing Epoch 021 train loss 1081.9667 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 022 train loss 1083.3400 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 023 train loss 1075.3784 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 024 train loss 1081.3041 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0103
0.0084
0.006
0.0044 
Recall:
 0.0317
0.0493
0.0818
0.1155 
NDCG:
 0.0223
0.0281
0.0373
0.0453 
MRR:
 0.0319
0.035
0.0375
0.0385
[Test]:  
Precision:
 0.0123
0.0093
0.0061
0.0044 
Recall:
 0.0588
0.0849
0.131
0.1779 
NDCG:
 0.0385
0.0464
0.0579
0.0676 
MRR:
0.0434
0.0466
0.049
0.0501
Runing Epoch 025 train loss 1083.5549 costs 00: 02: 49
------------------------------------------------------
Runing Epoch 026 train loss 1081.6622 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 027 train loss 1079.6541 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 028 train loss 1079.5014 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 029 train loss 1079.4006 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0103
0.0082
0.0058
0.0042 
Recall:
 0.0312
0.0478
0.0783
0.1095 
NDCG:
 0.022
0.0275
0.0361
0.0436 
MRR:
 0.0315
0.0345
0.0369
0.0378
[Test]:  
Precision:
 0.0122
0.0091
0.006
0.0042 
Recall:
 0.0583
0.0829
0.127
0.1701 
NDCG:
 0.0383
0.0457
0.0567
0.0657 
MRR:
0.0432
0.0462
0.0486
0.0496
Runing Epoch 030 train loss 1080.9329 costs 00: 02: 46
------------------------------------------------------
Runing Epoch 031 train loss 1083.5084 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 032 train loss 1080.7599 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 033 train loss 1081.1604 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 034 train loss 1078.5142 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0105
0.0084
0.006
0.0044 
Recall:
 0.0321
0.0493
0.0814
0.1148 
NDCG:
 0.0225
0.0283
0.0373
0.0453 
MRR:
 0.0321
0.0352
0.0377
0.0387
[Test]:  
Precision:
 0.0124
0.0094
0.0062
0.0044 
Recall:
 0.059
0.0847
0.1312
0.1769 
NDCG:
 0.0386
0.0464
0.0579
0.0674 
MRR:
0.0433
0.0465
0.049
0.05
Runing Epoch 035 train loss 1080.0973 costs 00: 02: 47
------------------------------------------------------
Runing Epoch 036 train loss 1080.3109 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 037 train loss 1080.3806 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 038 train loss 1078.9784 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 039 train loss 1079.6981 costs 00: 00: 37
------------------------------------------------------
[Valid]: 
Precision:
 0.0097
0.0078
0.0054
0.0039 
Recall:
 0.0292
0.0447
0.0722
0.1009 
NDCG:
 0.0208
0.0259
0.0337
0.0406 
MRR:
 0.0301
0.0329
0.0351
0.036
[Test]:  
Precision:
 0.0115
0.0085
0.0055
0.0039 
Recall:
 0.0543
0.0772
0.1168
0.1561 
NDCG:
 0.0362
0.0431
0.053
0.0613 
MRR:
0.0414
0.0442
0.0463
0.0472
Runing Epoch 040 train loss 1075.1503 costs 00: 02: 47
------------------------------------------------------
Runing Epoch 041 train loss 1081.1237 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 042 train loss 1079.7158 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 043 train loss 1078.9716 costs 00: 00: 37
------------------------------------------------------
Runing Epoch 044 train loss 1078.0124 costs 00: 00: 37
------------------------------------------------------
------------------
Exiting from training early
======================================================
End. Best Epoch 025 
[Valid]: 
Precision:
 0.0103
0.0084
0.006
0.0044 
Recall:
 0.0317
0.0493
0.0818
0.1155 
NDCG:
 0.0223
0.0281
0.0373
0.0453 
MRR:
 0.0319
0.035
0.0375
0.0385
[Test]:  
Precision:
 0.0123
0.0093
0.0061
0.0044 
Recall:
 0.0588
0.0849
0.131
0.1779 
NDCG:
 0.0385
0.0464
0.0579
0.0676 
MRR:
0.0434
0.0466
0.049
0.0501
End time:  2023-06-15 13:09:13
